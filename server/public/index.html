<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>WebRTC Data Channel Echo Server Example</title>
    <script type="module">
        let NUM_PACKETS = 20;
        let SEND_INTERVAL = 1;
        let ADDRESS = "/new_rtc_session";

        import init, {connect} from "./pkg/client.js";

        async function run() {
            await init();

            let peer = new RTCPeerConnection({
                iceServers: [{
                    urls: ["stun:stun.l.google.com:19302"]
                }]
            });
            let channel = await connect(peer);
            for (let i = 0; i < 25; i++) {
              channel.send_num(i);
            }

            setInterval(() => {
                let v = channel.recv();
                console.log(v);
                if (v) {
                    console.log(v);
                }
            }, 100);
        }

        run();
    </script>
</head>
<body></body>
</html>
